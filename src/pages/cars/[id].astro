---
import { getCollection, render } from "astro:content";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
  const f1Cars = await getCollection("f1Cars");

  return f1Cars.map((car) => ({
    params: { id: car.slug },
    props: { car },
  }));
}

const { car } = Astro.props;
const { data } = car;
const {
  nombre,
  escuderia,
  img,
  año,
  pilotos,
  motor,
  campeonatos_constructores,
  campeonatos_pilotos,
  victorias,
  pole_positions,
} = data;

const { Content } = await render(car);
---

<Layout title={`${nombre} - Autos Históricos`}>
  <div class="px-4 mx-auto max-w-screen-xl py-10">
    <div class="grid md:grid-cols-2 gap-8 items-start">
      <div class="relative group">
        <div
          class="absolute inset-0 bg-gradient-to-br from-red-800 to-black opacity-20 rounded-lg blur-lg"
        >
        </div>
        <img
          src={`/public/${img}`}
          alt={nombre}
          class="w-full rounded-lg shadow-2xl relative z-10 border-2 border-gray-800 object-cover"
        />
        <main>
            <div class="prose prose-invert prose-red mt-8 p-6 bg-gray-900 rounded-lg shadow-xl border border-gray-800 max-w-none text-gray-100">
                <Content />
            </div>
        </main>
      </div>

      <article
        class="bg-gray-900 p-8 rounded-lg shadow-xl border border-gray-800"
      >
        <header class="mb-6 border-b-2 border-red-700 pb-4">
          <h1 class="text-4xl md:text-5xl font-extrabold text-amber-50 mb-2">
            {nombre}
          </h1>
          <p class="text-2xl text-red-700 font-bold">{año}</p>
        </header>

        <div class="space-y-6 text-lg text-gray-300">
          <div class="grid grid-cols-1 gap-4">
            <p>
              <span class="font-semibold text-amber-50 block uppercase text-sm tracking-wider">Escudería</span>
              {escuderia}
            </p>
            <p>
              <span class="font-semibold text-amber-50 block uppercase text-sm tracking-wider">Motor</span>
              {motor}
            </p>
          </div>

          <div>
            <h3 class="font-semibold text-amber-50 text-xl mb-2">Pilotos</h3>
            <ul class="flex flex-wrap gap-2">
              {pilotos.map((piloto) => (
                <li class="bg-gray-800 px-3 py-1 rounded-full text-sm border border-gray-700 text-amber-50">
                  {piloto}
                </li>
              ))}
            </ul>
          </div>

          <div>
            <h3 class="font-semibold text-amber-50 text-xl mb-3">Estadísticas</h3>
            <div class="grid grid-cols-2 gap-4 bg-gray-800 p-4 rounded-lg">
              <div class="text-center">
                <span class="block text-2xl font-bold text-white">{victorias}</span>
                <span class="text-xs uppercase text-gray-400">Victorias</span>
              </div>
              <div class="text-center">
                <span class="block text-2xl font-bold text-white">{pole_positions}</span>
                <span class="text-xs uppercase text-gray-400">Poles</span>
              </div>
              <div class="text-center col-span-2 border-t border-gray-700 pt-2 mt-2">
                <span class="block text-xl font-bold text-amber-50">{campeonatos_constructores}</span>
                <span class="text-xs uppercase text-gray-400">Camp. Constructores</span>
              </div>
              <div class="text-center col-span-2">
                <span class="block text-xl font-bold text-amber-50">{campeonatos_pilotos}</span>
                <span class="text-xs uppercase text-gray-400">Camp. Pilotos</span>
              </div>
            </div>
          </div>
        </div>

        <div class="mt-8 pt-6 border-t border-gray-800">
          <a
            href="/"
            class="text-red-500 hover:text-red-400 font-semibold flex items-center gap-2 transition-colors"
          >
            ← Volver al listado
          </a>
        </div>
      </article>
    </div>
</div>
</Layout>
